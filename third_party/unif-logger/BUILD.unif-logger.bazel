load("@rules_pkg//pkg:mappings.bzl", "pkg_files", "pkg_filegroup")
load("@//rule:process_mcfunction.bzl", "process_mcfunction")
load("@//rule:process_json.bzl", "process_json")

pkg_files(
    name = "unif_logger_license",
    srcs = ["data/unif.logger/LICENSE"],
    visibility = ["//visibility:public"],
    strip_prefix = "data/unif.logger",
    prefix = "data/unif.logger",
)

process_mcfunction(
    name = "unif_logger_functions_processed",
    srcs = glob(["data/unif.logger/functions/**/*.mcfunction"]),
    pack_id = "unif.logger",
    keep_original_name = True,
)

pkg_files(
    name = "unif_logger_functions",
    srcs = [":unif_logger_functions_processed"],
    visibility = ["//visibility:public"],
    strip_prefix = "data/unif.logger/functions",
    prefix = "data/unif.logger/function",
)

pkg_files(
    name = "unif_logger_functions_legacy",
    srcs = [":unif_logger_functions_processed"],
    visibility = ["//visibility:public"],
    strip_prefix = "data/unif.logger/functions",
    prefix = "data/unif.logger/functions",
)

process_json(
    name = "unif_logger_tags_processed",
    srcs = glob(["data/unif.logger/tags/functions/**/*.json"]),
)

pkg_files(
    name = "unif_logger_tags",
    srcs = [":unif_logger_tags_processed"],
    visibility = ["//visibility:public"],
    strip_prefix = "data/unif.logger/tags/functions",
    prefix = "data/unif.logger/tags/function",
)

pkg_files(
    name = "unif_logger_tags_legacy",
    srcs = [":unif_logger_tags_processed"],
    visibility = ["//visibility:public"],
    strip_prefix = "data/unif.logger/tags/functions",
    prefix = "data/unif.logger/tags/functions",
)

pkg_filegroup(
    name = "unif-logger",
    visibility = ["//visibility:public"],
    srcs = [
        ":unif_logger_license",
        ":unif_logger_functions",
        ":unif_logger_functions_legacy",
        ":unif_logger_tags",
        ":unif_logger_tags_legacy",
    ],
)